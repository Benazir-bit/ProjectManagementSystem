{% extends "uspl/base.html" %}
{% block title %}On Board Notices{% endblock %}

{% block content %}
<div id="base-main-body" class="col-sm-8">
  <div class="row">
		<div class="col-sm-12">
			<br>
			<div id="main-body-div">
				<div id="main_body_header" class="row">
					<p><b>On Board Notices</b></p>
				</div>
				<div class="table-responsive">
					{% if notices %}
						<table id="member_table" class="table table-hover">
							<thead>
								<tr>
									<th>Title</th>
									<th>Expires On</th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								{% for notice in notices %}
									<tr id="row_mem{{group.id}}">
										<td>
											<a href="{% url 'uspl:notice_details' notice.id %}">{{notice.title}}</a>
											{% if notice.important %}
												<span class="badge" id="imp_badge">Important</span>
											{% endif %}
										</td>
										<td>
											{{notice.expires_on}}
										</td>
										<td>
											<button id = "edit_delete_btn" class="btn btn-info btn-sm" data-toggle="modal" data-target="#update_notice{{notice.id}}">
												<span class="glyphicon glyphicon-edit"></span> Edit
	        								</button>
	        								<!--Update Notice Modal -->
											<div class="modal fade" id="update_notice{{notice.id}}" role="dialog">
												<div class="modal-dialog">
													<!-- Modal content-->
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal">&times;</button>
															<h3 class="modal-title"><b>Update Notice<b></h3>
														</div>
														<div class="modal-body">
															<form method="post" class = "form-set"> 
																{% csrf_token %}
																<table class="table table-striped">
																	<input type="hidden" name="notice_id" value="{{notice.id}}">
																	<tr>
																		<td colspan="1" id = "table-form">
																			<label for="new_title">Title:</label>
																		</td>
																		<td>
																			<input type="text" name="new_title" class="form-control" value="{{notice.title}}">
																		</td>
																	</tr>
																	<tr>
																		<td colspan="1" id = "table-form">
																			<label for="new_body">Body:</label>
																		</td>
																		<td>
																			<textarea name="new_body" rows="10" style="width:100%">{{notice.body}}</textarea>
																		</td>
																	</tr>
																	<tr>
																		<td colspan="1" id = "table-form">
																			<label for="expires_on">Expires On:</label>
																		</td>
																		<td>
																			<input type="date" name="expires_on_date" value="{{notice.expires_on.date|date:"Y-m-d"}}"/><br><br>
																			<input type="time" name="expires_on_time" value="{{notice.expires_on.time|date:"H:i"}}"/>
																		</td>
																	</tr>
																	<tr>
																		<td colspan="1" id = "table-form">
																		</td>
																		<td>
																			<input type="checkbox" name="new_important" id="new_important" value="True" {% if notice.important %}checked{% endif %}><label for="new_important">Important?</label>
																		</td>
																	</tr>
																</table>
																<div class="row" align="center">
																	<button class="btn btn-primary" type="submit" role="button" name="update_notice"><b>Update<b></button>
																</div>
															</form>
														</div>
														<div class="modal-footer">
															<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
														</div>
													</div>
												</div>
											</div>
	        								<button id = "edit_delete_btn" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#delete_notice{{notice.id}}">
												<span class="glyphicon glyphicon-trash"></span> Delete
	        								</button>
	        								<div class="modal fade" id="delete_notice{{notice.id}}" role="dialog">
												<div class="modal-dialog">
													<!-- Modal content-->
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal">&times;</button>
															<h3 class="modal-title"><b>Delete Notice?<b></h3>
														</div>
														<div class="modal-body">
															<form method="post" class = "form-set"> 
																{% csrf_token %}
																<input type="hidden" name="notice_id" value="{{notice.id}}">
																<div class="row" align="center">
																	<p>Are you sure you want to delete this notice?</p>
																	<button class="btn btn-danger" type="submit" role="button" name="delete_notice"><b>Confirm<b></button>
																	<button type="button" class="btn btn-success" data-dismiss="modal">Cancel</button>
																</div>
															</form>
														</div>
														<div class="modal-footer">
															<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
														</div>
													</div>
												</div>
											</div>
										</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					{% else %}
						<br>
						<br>
						<h4 id="not-available-msg">No Notice Available On Board</h4>
					{% endif %}
				</div>
				<br>
				<br>
				<center>
					<a class="btn btn-success" href="{% url 'uspl:hr_notice_list_all' %}">View All Notices</a>
					<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#add_notice"><span class="glyphicon glyphicon-plus"></span> Add New Notice</button>
				</center>
				<br>
			</div>	
		</div>
	</div>
</div>	

<!--Add Notice Modal -->
<div class="modal fade" id="add_notice" role="dialog">
	<div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h3 class="modal-title"><b>Add New Notice<b></h3>
			</div>
			<div class="modal-body">
				<form method="post" class = "form-set"> 
					{% csrf_token %}
					<table class="table table-striped">
						<tr>
							<td colspan="1" id = "table-form">
								<label for="title">Title:</label>
							</td>
							<td>
								<input type="text" name="title" class="form-control" value="{{notice.title}}">
							</td>
						</tr>
						<tr>
							<td colspan="1" id = "table-form">
								<label for="body">Body:</label>
							</td>
							<td>
								<textarea name="body" rows="10" style="width:100%">{{notice.body}}</textarea>
							</td>
						</tr>
						<tr>
							<td colspan="1" id = "table-form">
								<label for="expires_on">Expires On:</label>
							</td>
							<td>
								<input type="date" name="expires_on_date" value="{{timenow.date|date:"Y-m-d"}}"/><br><br>
								<input type="time" name="expires_on_time" value="{{timenow.time|date:"H:i"}}"/>
							</td>
						</tr>
						<tr>
							<td colspan="1" id = "table-form">
							</td>
							<td>
								<input type="checkbox" name="important" id="important" value="True" {% if notice.important %}checked{% endif %}><label for="important">Important?</label>
							</td>
						</tr>
					</table>
					<div class="row" align="center">
						<button class="btn btn-primary" type="submit" role="button" name="add_notice"><b>Add<b></button>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block news %}
{% if not request.user.profile.is_hr %}
<!-- News -->
<div class="col-sm-2">
	<div class="fixed col-xs-2 sidebar-outer" id="news_col">
		<p id="news_header"><b>Recent Activities</b></p><br>
		<div class="scrollbar">
			{% for news in newses %}
				<div class="row event">
					<div class="col-xs-2 col-md-4 col-lg-3" id="news-pic">
						<a href="{% url 'uspl:employee_profile' news.owner.id %}"><img class="img-circle" id="news_pic" src="{{news.owner.profile.image.url}}"></a>
					</div>
					<div class="col-xs-9 col-md-8 col-lg-9" id="news_msg">
						<p><strong><b><a href="{% url 'uspl:employee_profile' news.owner.id %}">{{news.owner.get_full_name}}</a></b></strong> {{news.message}}<br></p>
						<p><span class="glyphicon glyphicon-time"></span> {{news.created_date}}</p>
					</div>
				</div>
				<hr>
			{% endfor %}
			</div>
				<p id="news_header"><b><a href="{% url 'uspl:news_list' 1 %}">View All</a></b></p>
			</div>
		</div>
	</div>
</div>
{% endif %}
{% endblock %}