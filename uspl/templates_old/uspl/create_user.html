{% extends "uspl/base.html" %}
{% block title %} Create New User {% endblock %}
{% block pagetitle %} Create New User {% endblock %}

{% block content %}
<div class="col-sm-8" id="base-main-body">
    <div class="row">
	   	<div class="col-sm-12">
		   	<br>
			<div id="main-body-div">
				<div class="row" id="main_body_header">
					<p><b>Create New User</b></p>
				</div>
				<br>
				<form method="post" id="userForm" data-dsgs-url="{% url 'uspl:ajax_load_dsgs' %}" enctype="multipart/form-data">
					{% csrf_token %}
					<div class="row">	
						<div class="col-md-12" id="table_modal_size">
							<br>
							{{form.errors}}
							<table class="table">
								<tbody>
									<tr>
										<td id="col1User"><label for="id_username">Employee ID:</label></td>
										<td id="col2User"><input type="text" class="form-control" id="id_username" placeholder="Enter Employee ID" name="username" required></td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_full_name">Full Name:</label></td>
										<td style="border:none">
											<div class="col-xs-6" id="col11"><input type="text" class="form-control" id="id_first_name" placeholder="First Name" name="first_name" required></div>
											<div class="col-xs-6" id="col12"><input type="text" class="form-control" id="id_last_name" placeholder="Last Name" name="last_name" required></div>
										</td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_email">Email:</label></td>
										<td id="col2User"><input type="email" class="form-control" id="id_email" placeholder="example@ulkasemi.com" name="email" required></td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_group">Group:</label></td>
										<td id="col2User">
										  <select name="group" id="id_group" class="form-control" required>
										    <option value="" disabled selected>Select Group</option>
										    {% for group in groups %}
											    <option value="{{group.id}}">{{group.name}}</option>
											  {% endfor %}
											</select>
										</td>
									</tr>
									<tr id="change_section">
										<td id="col1User"><label for="id_full_name"></label></td>
										<td style="border:none">
											<div class="col-xs-6" id="col11">
												<select id="id_report_to" class="form-control selectpicker" name="reports_to" required>
													<option value="">Select Manager</option>
												</select>
											</div>
											<div class="col-xs-6" id="col12">
												<select id="id_dsg" class="form-control" name="dsg" required>
										        	<option value="">Select Designation</option>
										        </select>
											</div>
										</td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_phone_number">Phone Number:</label></td>
										<td id="col2User"><input type="text" class="form-control" id="id_phone_number" placeholder="Enter Phone No" name="phone_number"  required></td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_present_address">Present Address:</label></td>
										<td id="col2User"><input type="text" class="form-control" id="id_present_address" placeholder="Enter Your Address" name="present_address"  required></td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_date_of_birth">Date of Birth:</label></td>
										<td id="col2User"><input type="date" class="form-control" id="id_date_of_birth" placeholder="dd/mm/yyyy" name="date_of_birth" required></td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_date_of_joining">Date of Joining:</label></td>
										<td id="col2User"><input type="date" class="form-control" id="id_date_of_joining" placeholder="dd/mm/yyyy" name="date_of_joining" required></td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_highest_degree">Highest Degree:</label></td>
										<td id="col2User"><input type="text" class="form-control" id="id_highest_degree" placeholder="Enter Highest Degree" name="highest_degree" required></td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_blood_group">Blood Group:</label></td>
										<td id="col2User"><input type="text" class="form-control" id="id_blood_group" placeholder="Enter Blood Group" name="blood_group" required></td>
									</tr>
									<tr>
										<td id="col1User"><label for="id_emergency_contact">Emergency Contact:</label></td>
										<td id="col2User"><input type="text" class="form-control" id="id_emergency_contact" placeholder="Enter Emergency Contact" name="emergency_contact" required></td>
									</tr>
								</tbody>
							</table><br>
							<div class="row" id="create_user_submit">
								<button class="btn btn-primary" type="submit">Submit</button>
							</div><br>
						</div>	
					</div>
          		</form>
          	</div>
        </div>
    </div>
</div>
{% endblock %}

{% block news %}
{% if not request.user.profile.is_hr %}
<!-- News -->
<div class="col-sm-2">
	<div class="fixed col-xs-2 sidebar-outer" id="news_col">
		<p id="news_header"><b>Recent Activities</b></p><br>
		<div class="scrollbar">
			{% for news in newses %}
				<div class="row event">
					<div class="col-xs-2 col-md-4 col-lg-3" id="news-pic">
						<a href="{% url 'uspl:employee_profile' news.owner.id %}"><img class="img-circle" id="news_pic" src="{{news.owner.profile.image.url}}"></a>
					</div>
					<div class="col-xs-9 col-md-8 col-lg-9" id="news_msg">
						<p><strong><b><a href="{% url 'uspl:employee_profile' news.owner.id %}">{{news.owner.get_full_name}}</a></b></strong> {{news.message}}<br></p>
						<p><span class="glyphicon glyphicon-time"></span> {{news.created_date}}</p>
					</div>
				</div>
				<hr>
			{% endfor %}
			</div>
				<p id="news_header"><b><a href="{% url 'uspl:news_list' 1 %}">View All</a></b></p>
			</div>
		</div>
	</div>
</div>
{% endif %}
{% endblock %}

{% block external_js %}
<script>
$("#id_group").change(function () {
	$("#id_dsg").val("");
	$("#id_report_to").val("");
    var url = $("#userForm").attr("data-dsgs-url");
    var groupId = $(this).val();
    $.ajax({            
    	url: url,
    	data: {
    		'group': groupId 
    	},
    	success: function (data) {
    		$('#change_section').empty();
    		$("#id_dsg").attr("disabled", "false");
			$("#id_report_to").attr("disabled", "false");
    		$("#change_section").html(data);
    		$('.selectpicker').selectpicker('refresh');
    	}
    });
});
</script>
{% endblock %}